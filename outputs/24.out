	Working on 0
wandb: Currently logged in as: naddeok (use `wandb login --relogin` to force relogin)
wandb: wandb version 0.12.9 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
2022-01-03 16:48:30.172122: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.2
2022-01-03 16:48:30.199526: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.2
wandb: Tracking run with wandb version 0.12.3
wandb: Syncing run stilted-lion-1
wandb:  View project at https://wandb.ai/naddeok/DDP%20Variety%20MNIST
wandb:  View run at https://wandb.ai/naddeok/DDP%20Variety%20MNIST/runs/16d6bg07
wandb: Run data is saved locally in /home/naddeok5/FIM/wandb/run-20220103_164828-16d6bg07
wandb: Run `wandb offline` to turn off syncing.
Augmenting Training Data on Rank  1

Augmenting Training Data on Rank  0
Trainning on Rank 0
Trainning on Rank 1
Epoch:  2 	Train/Val Loss:  29.72199 / 2.71714 	Train/Val Acc:  83.36 / 91.65
Epoch:  4 	Train/Val Loss:  12.52634 / 1.41993 	Train/Val Acc:  93.38 / 95.66
Testing on Rank 1
Testing on Rank 0
Evaluating Results 1
Val Gathered 1
Adv Gathered 1
Evaluating Results 0
Val Gathered 0
Adv Gathered 0
Logging
Log
Save Attack Results
Saving Model
Model Saved
wandb: Waiting for W&B process to finish, PID 1257226... (success).
wandb: - 0.00MB of 0.00MB uploaded (0.00MB deduped)wandb: \ 0.00MB of 0.00MB uploaded (0.00MB deduped)wandb: | 0.00MB of 0.00MB uploaded (0.00MB deduped)wandb: / 0.00MB of 0.00MB uploaded (0.00MB deduped)wandb: - 0.00MB of 0.01MB uploaded (0.00MB deduped)wandb: \ 0.00MB of 0.01MB uploaded (0.00MB deduped)wandb: | 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: / 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: - 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: \ 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: | 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: / 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Run history:
wandb:        Epoch ▁
wandb:    Train Acc ▁█
wandb:   Train Loss █▁
wandb:      Val Acc ▁██
wandb:     Val Loss █▁▁
wandb:        epoch ▁█
wandb:     sched lr ▁▁▂▂▃▄▅▆▆▇███████▇▇▇▇▆▆▅▅▅▄▄▄▃▃▂▂▂▂▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:      Epoch 5
wandb:    Val Acc 0.9594
wandb:   Val Loss 1.3511
wandb:      epoch 4
wandb:   sched lr 1e-05
wandb: 
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Synced stilted-lion-1: https://wandb.ai/naddeok/DDP%20Variety%20MNIST/runs/16d6bg07
wandb: Find logs at: ./wandb/run-20220103_164828-16d6bg07/logs/debug.log
wandb: 

WandB Finished
Run Complete
wandb: Currently logged in as: naddeok (use `wandb login --relogin` to force relogin)
wandb: wandb version 0.12.9 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
2022-01-03 16:49:55.554398: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.2
2022-01-03 16:49:55.559337: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.2
wandb: Tracking run with wandb version 0.12.3
wandb: Syncing run polar-sky-2
wandb:  View project at https://wandb.ai/naddeok/DDP%20Variety%20MNIST
wandb:  View run at https://wandb.ai/naddeok/DDP%20Variety%20MNIST/runs/v6es767g
wandb: Run data is saved locally in /home/naddeok5/FIM/wandb/run-20220103_164953-v6es767g
wandb: Run `wandb offline` to turn off syncing.
models/pretrained/MNIST/U_w_means_0-10024631768465042_and_stds_0-9899614453315735_.pt  is Loaded.
Augmenting Training Data on Rank  1

models/pretrained/MNIST/U_w_means_0-10024631768465042_and_stds_0-9899614453315735_.pt  is Loaded.
Augmenting Training Data on Rank  0
Trainning on Rank 0
Trainning on Rank 1
Epoch:  2 	Train/Val Loss:  36.81961 / 3.69289 	Train/Val Acc:  79.43 / 87.73
Epoch:  4 	Train/Val Loss:  18.28165 / 2.28799 	Train/Val Acc:  90.15 / 92.74
Testing on Rank 1
Testing on Rank 0
[lambda01:1278398] tcp_peer_recv_connect_ack: invalid header type: 114
[lambda01:1256996] tcp_peer_recv_connect_ack: invalid header type: 114
[lambda01:1278397] tcp_peer_recv_connect_ack: invalid header type: 114
[lambda01:1278501] tcp_peer_recv_connect_ack: invalid header type: 114
[lambda01:1278398] tcp_peer_recv_connect_ack: invalid header type: 55
[lambda01:1278398] tcp_peer_recv_connect_ack: invalid header type: 90
[lambda01:1278398] tcp_peer_recv_connect_ack: invalid header type: 187
[lambda01:1278398] tcp_peer_recv_connect_ack: invalid header type: 3
[lambda01:1278398] tcp_peer_recv_connect_ack: invalid header type: 247
[lambda01:1278398] tcp_peer_recv_connect_ack: invalid header type: 113
[lambda01:1278398] tcp_peer_recv_connect_ack: invalid header type: 117
[lambda01:1278398] tcp_peer_recv_connect_ack: invalid header type: 128
[lambda01:1256996] tcp_peer_recv_connect_ack: invalid header type: 75
[lambda01:1256996] tcp_peer_recv_connect_ack: invalid header type: 25
[lambda01:1256996] tcp_peer_recv_connect_ack: invalid header type: 5
[lambda01:1256996] tcp_peer_recv_connect_ack: invalid header type: 175
[lambda01:1256996] tcp_peer_recv_connect_ack: invalid header type: 216
[lambda01:1256996] tcp_peer_recv_connect_ack: invalid header type: 80
[lambda01:1256996] tcp_peer_recv_connect_ack: invalid header type: 66
[lambda01:1256996] tcp_peer_recv_connect_ack: invalid header type: 128
[lambda01:1278397] tcp_peer_recv_connect_ack: invalid header type: 111
[lambda01:1278397] tcp_peer_recv_connect_ack: invalid header type: 46
[lambda01:1278397] tcp_peer_recv_connect_ack: invalid header type: 52
[lambda01:1278397] tcp_peer_recv_connect_ack: invalid header type: 112
[lambda01:1278397] tcp_peer_recv_connect_ack: invalid header type: 76
[lambda01:1278397] tcp_peer_recv_connect_ack: invalid header type: 87
[lambda01:1278397] tcp_peer_recv_connect_ack: invalid header type: 109
[lambda01:1278397] tcp_peer_recv_connect_ack: invalid header type: 128
[lambda01:1278501] tcp_peer_recv_connect_ack: invalid header type: 94
[lambda01:1278501] tcp_peer_recv_connect_ack: invalid header type: 128
[lambda01:1278501] tcp_peer_recv_connect_ack: invalid header type: 64
[lambda01:1278501] tcp_peer_recv_connect_ack: invalid header type: 17
[lambda01:1278501] tcp_peer_recv_connect_ack: invalid header type: 171
[lambda01:1278501] tcp_peer_recv_connect_ack: invalid header type: 71
[lambda01:1278501] tcp_peer_recv_connect_ack: invalid header type: 122
[lambda01:1278501] tcp_peer_recv_connect_ack: invalid header type: 128
[lambda01:1278398] tcp_peer_recv_connect_ack: invalid header type: 100
[lambda01:1278398] tcp_peer_recv_connect_ack: invalid header type: 58
[lambda01:1278398] tcp_peer_recv_connect_ack: invalid header type: 58
[lambda01:1278398] tcp_peer_recv_connect_ack: invalid header type: 99
[lambda01:1278501] tcp_peer_recv_connect_ack: invalid header type: 100
[lambda01:1278501] tcp_peer_recv_connect_ack: invalid header type: 99
[lambda01:1278501] tcp_peer_recv_connect_ack: invalid header type: 58
[lambda01:1278501] tcp_peer_recv_connect_ack: invalid header type: 58
[lambda01:1278397] tcp_peer_recv_connect_ack: invalid header type: 100
[lambda01:1278397] tcp_peer_recv_connect_ack: invalid header type: 99
[lambda01:1256996] tcp_peer_recv_connect_ack: invalid header type: 100
[lambda01:1256996] tcp_peer_recv_connect_ack: invalid header type: 99
[lambda01:1278397] tcp_peer_recv_connect_ack: invalid header type: 58
[lambda01:1278397] tcp_peer_recv_connect_ack: invalid header type: 58
[lambda01:1256996] tcp_peer_recv_connect_ack: invalid header type: 58
[lambda01:1256996] tcp_peer_recv_connect_ack: invalid header type: 58
[lambda01:1278398] tcp_peer_recv_connect_ack: invalid header type: 114
[lambda01:1256996] tcp_peer_recv_connect_ack: invalid header type: 114
[lambda01:1278397] tcp_peer_recv_connect_ack: invalid header type: 114
[lambda01:1278501] tcp_peer_recv_connect_ack: invalid header type: 114
[lambda01:1278398] tcp_peer_recv_connect_ack: invalid header type: 4
[lambda01:1278398] tcp_peer_recv_connect_ack: invalid header type: 252
[lambda01:1278398] tcp_peer_recv_connect_ack: invalid header type: 102
[lambda01:1278398] tcp_peer_recv_connect_ack: invalid header type: 44
[lambda01:1278398] tcp_peer_recv_connect_ack: invalid header type: 246
[lambda01:1278398] tcp_peer_recv_connect_ack: invalid header type: 69
[lambda01:1278398] tcp_peer_recv_connect_ack: invalid header type: 98
[lambda01:1278398] tcp_peer_recv_connect_ack: invalid header type: 128
[lambda01:1256996] tcp_peer_recv_connect_ack: invalid header type: 85
[lambda01:1256996] tcp_peer_recv_connect_ack: invalid header type: 73
[lambda01:1256996] tcp_peer_recv_connect_ack: invalid header type: 76
[lambda01:1256996] [[63469,0],0] tcp_peer_recv_blocking: recv() failed for [[513,790],16777472]: Connection reset by peer (104)
[lambda01:1256996] tcp_peer_recv_connect_ack: invalid header type: 240
[lambda01:1256996] tcp_peer_recv_connect_ack: invalid header type: 75
[lambda01:1256996] tcp_peer_recv_connect_ack: invalid header type: 69
[lambda01:1256996] tcp_peer_recv_connect_ack: invalid header type: 128
[lambda01:1278397] tcp_peer_recv_connect_ack: invalid header type: 19
[lambda01:1278397] tcp_peer_recv_connect_ack: invalid header type: 37
[lambda01:1278397] tcp_peer_recv_connect_ack: invalid header type: 209
[lambda01:1278397] tcp_peer_recv_connect_ack: invalid header type: 232
[lambda01:1278397] tcp_peer_recv_connect_ack: invalid header type: 213
[lambda01:1278397] tcp_peer_recv_connect_ack: invalid header type: 71
[lambda01:1278397] tcp_peer_recv_connect_ack: invalid header type: 77
[lambda01:1278397] tcp_peer_recv_connect_ack: invalid header type: 128
[lambda01:1278501] tcp_peer_recv_connect_ack: invalid header type: 130
[lambda01:1278501] tcp_peer_recv_connect_ack: invalid header type: 122
[lambda01:1278501] tcp_peer_recv_connect_ack: invalid header type: 194
[lambda01:1278501] tcp_peer_recv_connect_ack: invalid header type: 110
[lambda01:1278501] tcp_peer_recv_connect_ack: invalid header type: 134
[lambda01:1278501] tcp_peer_recv_connect_ack: invalid header type: 78
[lambda01:1278501] tcp_peer_recv_connect_ack: invalid header type: 103
[lambda01:1278501] tcp_peer_recv_connect_ack: invalid header type: 128
[lambda01:1256996] tcp_peer_recv_connect_ack: invalid header type: 100
[lambda01:1256996] tcp_peer_recv_connect_ack: invalid header type: 99
[lambda01:1256996] tcp_peer_recv_connect_ack: invalid header type: 58
[lambda01:1256996] tcp_peer_recv_connect_ack: invalid header type: 58
[lambda01:1278501] tcp_peer_recv_connect_ack: invalid header type: 100
[lambda01:1278397] tcp_peer_recv_connect_ack: invalid header type: 100
[lambda01:1278398] tcp_peer_recv_connect_ack: invalid header type: 100
[lambda01:1278501] tcp_peer_recv_connect_ack: invalid header type: 99
[lambda01:1278397] tcp_peer_recv_connect_ack: invalid header type: 99
[lambda01:1278398] tcp_peer_recv_connect_ack: invalid header type: 99
[lambda01:1278501] tcp_peer_recv_connect_ack: invalid header type: 58
[lambda01:1278501] tcp_peer_recv_connect_ack: invalid header type: 58
[lambda01:1278397] tcp_peer_recv_connect_ack: invalid header type: 58
[lambda01:1278397] tcp_peer_recv_connect_ack: invalid header type: 58
[lambda01:1278398] tcp_peer_recv_connect_ack: invalid header type: 58
[lambda01:1278398] tcp_peer_recv_connect_ack: invalid header type: 58
[lambda01:1278398] tcp_peer_recv_connect_ack: invalid header type: 114
[lambda01:1256996] tcp_peer_recv_connect_ack: invalid header type: 114
[lambda01:1278397] tcp_peer_recv_connect_ack: invalid header type: 114
[lambda01:1278501] tcp_peer_recv_connect_ack: invalid header type: 114
[lambda01:1278398] tcp_peer_recv_connect_ack: invalid header type: 179
[lambda01:1278398] tcp_peer_recv_connect_ack: invalid header type: 8
[lambda01:1278398] tcp_peer_recv_connect_ack: invalid header type: 155
[lambda01:1278398] tcp_peer_recv_connect_ack: invalid header type: 46
[lambda01:1278398] tcp_peer_recv_connect_ack: invalid header type: 99
[lambda01:1278398] tcp_peer_recv_connect_ack: invalid header type: 83
[lambda01:1278398] tcp_peer_recv_connect_ack: invalid header type: 128
[lambda01:1256996] tcp_peer_recv_connect_ack: invalid header type: 124
[lambda01:1256996] tcp_peer_recv_connect_ack: invalid header type: 180
[lambda01:1256996] tcp_peer_recv_connect_ack: invalid header type: 232
[lambda01:1256996] tcp_peer_recv_connect_ack: invalid header type: 132
[lambda01:1256996] tcp_peer_recv_connect_ack: invalid header type: 224
[lambda01:1256996] tcp_peer_recv_connect_ack: invalid header type: 75
[lambda01:1256996] tcp_peer_recv_connect_ack: invalid header type: 73
[lambda01:1256996] tcp_peer_recv_connect_ack: invalid header type: 128
[lambda01:1278397] tcp_peer_recv_connect_ack: invalid header type: 190
[lambda01:1278397] tcp_peer_recv_connect_ack: invalid header type: 114
[lambda01:1278397] tcp_peer_recv_connect_ack: invalid header type: 186
[lambda01:1278397] tcp_peer_recv_connect_ack: invalid header type: 240
[lambda01:1278397] tcp_peer_recv_connect_ack: invalid header type: 103
[lambda01:1278397] tcp_peer_recv_connect_ack: invalid header type: 113
[lambda01:1278397] tcp_peer_recv_connect_ack: invalid header type: 118
[lambda01:1278397] tcp_peer_recv_connect_ack: invalid header type: 128
[lambda01:1278501] tcp_peer_recv_connect_ack: invalid header type: 176
[lambda01:1278501] tcp_peer_recv_connect_ack: invalid header type: 8
[lambda01:1278501] tcp_peer_recv_connect_ack: invalid header type: 165
[lambda01:1278501] tcp_peer_recv_connect_ack: invalid header type: 226
[lambda01:1278501] tcp_peer_recv_connect_ack: invalid header type: 17
[lambda01:1278501] tcp_peer_recv_connect_ack: invalid header type: 77
[lambda01:1278501] tcp_peer_recv_connect_ack: invalid header type: 114
[lambda01:1278501] tcp_peer_recv_connect_ack: invalid header type: 128
[lambda01:1278501] tcp_peer_recv_connect_ack: invalid header type: 100
[lambda01:1278501] tcp_peer_recv_connect_ack: invalid header type: 99
[lambda01:1278501] tcp_peer_recv_connect_ack: invalid header type: 58
[lambda01:1278501] tcp_peer_recv_connect_ack: invalid header type: 58
[lambda01:1278397] tcp_peer_recv_connect_ack: invalid header type: 100
[lambda01:1256996] tcp_peer_recv_connect_ack: invalid header type: 100
[lambda01:1278398] tcp_peer_recv_connect_ack: invalid header type: 100
[lambda01:1278397] tcp_peer_recv_connect_ack: invalid header type: 99
[lambda01:1256996] tcp_peer_recv_connect_ack: invalid header type: 99
[lambda01:1278398] tcp_peer_recv_connect_ack: invalid header type: 99
[lambda01:1278397] tcp_peer_recv_connect_ack: invalid header type: 58
[lambda01:1278397] tcp_peer_recv_connect_ack: invalid header type: 58
[lambda01:1256996] tcp_peer_recv_connect_ack: invalid header type: 58
[lambda01:1256996] tcp_peer_recv_connect_ack: invalid header type: 58
[lambda01:1278398] tcp_peer_recv_connect_ack: invalid header type: 58
[lambda01:1278398] tcp_peer_recv_connect_ack: invalid header type: 58
[lambda01:1278398] tcp_peer_recv_connect_ack: invalid header type: 114
[lambda01:1256996] tcp_peer_recv_connect_ack: invalid header type: 114
[lambda01:1278397] tcp_peer_recv_connect_ack: invalid header type: 114
[lambda01:1278501] tcp_peer_recv_connect_ack: invalid header type: 114
[lambda01:1278398] tcp_peer_recv_connect_ack: invalid header type: 190
[lambda01:1278398] tcp_peer_recv_connect_ack: invalid header type: 132
[lambda01:1278398] tcp_peer_recv_connect_ack: invalid header type: 69
[lambda01:1278398] tcp_peer_recv_connect_ack: invalid header type: 132
[lambda01:1278398] tcp_peer_recv_connect_ack: invalid header type: 208
[lambda01:1278398] tcp_peer_recv_connect_ack: invalid header type: 87
[lambda01:1278398] tcp_peer_recv_connect_ack: invalid header type: 51
[lambda01:1278398] tcp_peer_recv_connect_ack: invalid header type: 128
[lambda01:1256996] tcp_peer_recv_connect_ack: invalid header type: 47
[lambda01:1256996] tcp_peer_recv_connect_ack: invalid header type: 210
[lambda01:1256996] tcp_peer_recv_connect_ack: invalid header type: 230
[lambda01:1256996] tcp_peer_recv_connect_ack: invalid header type: 121
[lambda01:1256996] tcp_peer_recv_connect_ack: invalid header type: 145
[lambda01:1256996] tcp_peer_recv_connect_ack: invalid header type: 88
[lambda01:1256996] tcp_peer_recv_connect_ack: invalid header type: 119
[lambda01:1256996] tcp_peer_recv_connect_ack: invalid header type: 128
[lambda01:1278397] tcp_peer_recv_connect_ack: invalid header type: 7
[lambda01:1278397] tcp_peer_recv_connect_ack: invalid header type: 170
[lambda01:1278397] tcp_peer_recv_connect_ack: invalid header type: 186
[lambda01:1278397] tcp_peer_recv_connect_ack: invalid header type: 251
[lambda01:1278397] tcp_peer_recv_connect_ack: invalid header type: 151
[lambda01:1278397] tcp_peer_recv_connect_ack: invalid header type: 104
[lambda01:1278397] tcp_peer_recv_connect_ack: invalid header type: 84
[lambda01:1278397] tcp_peer_recv_connect_ack: invalid header type: 128
[lambda01:1278501] tcp_peer_recv_connect_ack: invalid header type: 211
[lambda01:1278501] tcp_peer_recv_connect_ack: invalid header type: 155
[lambda01:1278501] tcp_peer_recv_connect_ack: invalid header type: 28
[lambda01:1278501] tcp_peer_recv_connect_ack: invalid header type: 65
[lambda01:1278501] tcp_peer_recv_connect_ack: invalid header type: 191
[lambda01:1278501] tcp_peer_recv_connect_ack: invalid header type: 103
[lambda01:1278501] tcp_peer_recv_connect_ack: invalid header type: 110
[lambda01:1278501] tcp_peer_recv_connect_ack: invalid header type: 128
[lambda01:1278501] tcp_peer_recv_connect_ack: invalid header type: 99
[lambda01:1278501] tcp_peer_recv_connect_ack: invalid header type: 100
[lambda01:1278501] tcp_peer_recv_connect_ack: invalid header type: 58
[lambda01:1278501] tcp_peer_recv_connect_ack: invalid header type: 58
[lambda01:1278397] tcp_peer_recv_connect_ack: invalid header type: 99
[lambda01:1256996] tcp_peer_recv_connect_ack: invalid header type: 99
[lambda01:1278398] tcp_peer_recv_connect_ack: invalid header type: 99
[lambda01:1278397] tcp_peer_recv_connect_ack: invalid header type: 100
[lambda01:1256996] tcp_peer_recv_connect_ack: invalid header type: 100
[lambda01:1278398] tcp_peer_recv_connect_ack: invalid header type: 100
[lambda01:1278397] tcp_peer_recv_connect_ack: invalid header type: 58
[lambda01:1278397] tcp_peer_recv_connect_ack: invalid header type: 58
[lambda01:1256996] tcp_peer_recv_connect_ack: invalid header type: 58
[lambda01:1256996] tcp_peer_recv_connect_ack: invalid header type: 58
[lambda01:1278398] tcp_peer_recv_connect_ack: invalid header type: 58
[lambda01:1278398] tcp_peer_recv_connect_ack: invalid header type: 58
/usr/lib/python3.8/multiprocessing/resource_tracker.py:216: UserWarning: resource_tracker: There appear to be 4 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
